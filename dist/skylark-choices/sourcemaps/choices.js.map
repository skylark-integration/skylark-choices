{"version":3,"sources":["choices.js"],"names":["define","Fuse","merge","Store","components","constants","TEMPLATES","actionsChoices","items","groups","misc","h","IS_IE11","document","documentElement","style","USER_DEFAULTS","Choices","defaults","Object","preventExtensions","options","templates","[object Object]","element","userConfig","this","config","all","DEFAULT_CONFIG","arrayMerge","_","sourceArray","invalidConfigOptions","diff","length","console","warn","join","passedElement","querySelector","HTMLInputElement","HTMLSelectElement","TypeError","_isTextElement","type","TEXT_TYPE","_isSelectOneElement","SELECT_ONE_TYPE","_isSelectMultipleElement","SELECT_MULTIPLE_TYPE","_isSelectElement","searchEnabled","includes","renderSelectedChoices","addItemFilter","re","RegExp","test","bind","WrappedInput","classNames","delimiter","WrappedSelect","template","data","_templates","option","initialised","_store","_initialState","_currentState","_prevState","_currentValue","_canSearch","_isScrollingOnIe","_highlightPosition","_wasTap","_placeholderValue","_generatePlaceholderValue","_baseId","generateId","_direction","dir","direction","elementDirection","window","getComputedStyle","documentDirection","_idNames","itemChoice","_presetGroups","optionGroups","_presetOptions","_presetChoices","choices","_presetItems","value","concat","split","forEach","o","push","label","innerHTML","selected","disabled","parentNode","placeholder","hasAttribute","customProperties","getAttribute","_render","_onFocus","_onBlur","_onKeyUp","_onKeyDown","_onClick","_onTouchMove","_onTouchEnd","_onMouseDown","_onMouseOver","_onFormReset","_onAKey","_onEnterKey","_onEscapeKey","_onDirectionKey","_onDeleteKey","isActive","silent","init","_createTemplates","_createElements","_createStructure","cloneObject","state","subscribe","_addEventListeners","addItems","disable","callbackOnInit","call","_removeEventListeners","reveal","containerOuter","unwrap","clearStore","isDisabled","enable","input","item","runEvent","id","groupId","group","getGroupById","dispatch","highlightItem","triggerEvent","EVENTS","undefined","groupValue","unhighlightItem","activeItems","filter","_removeItem","excludedId","highlightedActiveItems","_triggerChange","preventInputFocus","dropdown","requestAnimationFrame","show","open","distanceFromTopWindow","focus","showDropdown","preventInputBlur","hide","close","removeActiveDescendant","blur","hideDropdown","valueOnly","values","reduce","selectedItems","itemValue","_setChoiceOrItem","Array","isArray","val","_findAndSelectChoiceByValue","choicesArrayOrFetcher","replaceChoices","ReferenceError","fetcher","Promise","resolve","then","_handleLoadingState","setChoices","catch","err","error","removeLoadingState","_startLoading","groupOrChoice","_addGroup","parseInt","valueKey","labelKey","_addChoice","isSelected","_stopLoading","clearChoices","clearAll","shouldSetInputWidth","clear","_isSearching","d","activateChoices","isLoading","stateChanged","shouldRenderChoices","shouldRenderItems","_renderChoices","_renderItems","activeGroups","activeChoices","choiceListFragment","createDocumentFragment","choiceList","resetScrollPosition","scrollToTop","activePlaceholders","activeChoice","_createChoicesFragment","_createGroupsFragment","childNodes","canAddItem","_canAddItem","response","append","_highlightChoice","_getTemplate","notice","dropdownItem","noResultsText","noChoicesText","itemList","itemListFragment","_createItemsFragment","fragment","getGroupChoices","choice","shouldSort","sort","sorter","groupChoices","dropdownGroup","appendChild","withinGroup","searchResultLimit","renderChoiceLimit","sortByScore","appendChoice","itemSelectText","rendererableChoices","placeholderChoices","normalChoices","acc","choiceLimit","sortedChoices","i","shouldSortItems","removeItemButton","listItem","change","placeholderChoice","_addItem","choiceId","removeItems","itemId","itemToRemove","find","_selectPlaceholderChoice","hasShiftKey","passedId","highlighted","dataset","getChoiceById","passedKeyCode","keyCode","hasActiveDropdown","clearInput","lastItem","hasHighlightedItems","some","editItems","setWidth","removeHighlightedItems","setIsLoading","setLoading","placeholderItem","getChild","addLoadingState","loadingText","isFocussed","searchFloor","searchChoices","hasUnactiveChoices","active","resultCount","_searchChoices","search","addItemText","isDuplicateValue","existsInArray","maxItemCount","maxItemText","duplicateItemsAllowed","uniqueItemText","customAddItemText","newValue","trim","currentValue","haystack","searchableChoices","needle","keys","searchFields","assign","fuseOptions","results","filterChoices","addEventListener","passive","form","addEventListeners","removeEventListener","removeEventListeners","event","target","ctrlKey","metaKey","hasFocusedInput","hasItems","hasChildren","keyString","String","fromCharCode","BACK_KEY","DELETE_KEY","ENTER_KEY","A_KEY","ESC_KEY","UP_KEY","DOWN_KEY","PAGE_UP_KEY","PAGE_DOWN_KEY","KEY_CODES","hasCtrlDownKeyPressed","keyDownActions","backKey","deleteKey","outerHTML","userHasRemovedValue","canReactivateChoices","canSearch","_handleSearch","activeElement","highlightAll","enterKey","targetWasButton","_handleButtonAction","preventDefault","highlightedChoice","highlightedState","_handleChoiceAction","downKey","pageUpKey","pageDownKey","directionInt","selectableChoiceIdentifier","nextEl","currentEl","getAdjacentEl","isScrolledIntoView","scrollToChildElement","_handleBackspace","touches","contains","containerInner","stopPropagation","HTMLElement","firstChoice","firstElementChild","isOnScrollbar","offsetX","offsetWidth","offsetLeft","closest","shiftKey","_handleItemAction","unhighlightAll","removeFocusState","addFocusState","resetTo","el","from","querySelectorAll","passedEl","classList","remove","setAttribute","indexOf","add","highlightChoice","setActiveDescendant","passedValue","passedCustomProperties","passedLabel","passedOptionId","prependValue","toString","appendValue","addItem","removeActiveItems","isType","removeItem","choiceLabel","choiceElementId","addChoice","elementId","getElementsByTagName","Math","floor","Date","valueOf","random","addGroup","addGroupChoices","isOptDisabled","args","callbackOnCreateTemplates","userTemplates","strToEl","Container","position","Input","preventPaste","paste","List","Dropdown","conceal","wrap","searchPlaceholderValue","insertBefore","firstChild","_addPredefinedGroups","_addPredefinedChoices","_addPredefinedItems","placeholderOption","tagName","hasSelectedChoice","firstEnabledChoiceIndex","findIndex","index","object","string","getType","toLowerCase","foundChoice","valueComparer","text","placeholderValue"],"mappings":"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","file":"../choices.js","sourcesContent":["define([\n    './vendors/fuse',\n    './vendors/deepmerge',\n    './store/store',\n    './components/index',\n    './constants',\n    './templates',\n    './actions/choices',\n    './actions/items',\n    './actions/groups',\n    './actions/misc',\n    './lib/utils'\n], function (Fuse, merge, Store, components, constants, TEMPLATES, actionsChoices, items, groups, misc, h) {\n    'use strict';\n    const IS_IE11 = '-ms-scroll-limit' in document.documentElement.style && '-ms-ime-align' in document.documentElement.style;\n    const USER_DEFAULTS = {};\n    class Choices {\n        static get defaults() {\n            return Object.preventExtensions({\n                get options() {\n                    return USER_DEFAULTS;\n                },\n                get templates() {\n                    return TEMPLATES;\n                }\n            });\n        }\n        constructor(element = '[data-choice]', userConfig = {}) {\n            this.config = merge.all([\n                constants.DEFAULT_CONFIG,\n                Choices.defaults.options,\n                userConfig\n            ], { arrayMerge: (_, sourceArray) => [...sourceArray] });\n            const invalidConfigOptions = h.diff(this.config, constants.DEFAULT_CONFIG);\n            if (invalidConfigOptions.length) {\n                console.warn('Unknown config option(s) passed', invalidConfigOptions.join(', '));\n            }\n            const passedElement = typeof element === 'string' ? document.querySelector(element) : element;\n            if (!(passedElement instanceof HTMLInputElement || passedElement instanceof HTMLSelectElement)) {\n                throw TypeError('Expected one of the following types text|select-one|select-multiple');\n            }\n            this._isTextElement = passedElement.type === constants.TEXT_TYPE;\n            this._isSelectOneElement = passedElement.type === constants.SELECT_ONE_TYPE;\n            this._isSelectMultipleElement = passedElement.type === constants.SELECT_MULTIPLE_TYPE;\n            this._isSelectElement = this._isSelectOneElement || this._isSelectMultipleElement;\n            this.config.searchEnabled = this._isSelectMultipleElement || this.config.searchEnabled;\n            if (![\n                    'auto',\n                    'always'\n                ].includes(this.config.renderSelectedChoices)) {\n                this.config.renderSelectedChoices = 'auto';\n            }\n            if (userConfig.addItemFilter && typeof userConfig.addItemFilter !== 'function') {\n                const re = userConfig.addItemFilter instanceof RegExp ? userConfig.addItemFilter : new RegExp(userConfig.addItemFilter);\n                this.config.addItemFilter = re.test.bind(re);\n            }\n            if (this._isTextElement) {\n                this.passedElement = new components.WrappedInput({\n                    element: passedElement,\n                    classNames: this.config.classNames,\n                    delimiter: this.config.delimiter\n                });\n            } else {\n                this.passedElement = new components.WrappedSelect({\n                    element: passedElement,\n                    classNames: this.config.classNames,\n                    template: data => this._templates.option(data)\n                });\n            }\n            this.initialised = false;\n            this._store = new Store();\n            this._initialState = {};\n            this._currentState = {};\n            this._prevState = {};\n            this._currentValue = '';\n            this._canSearch = this.config.searchEnabled;\n            this._isScrollingOnIe = false;\n            this._highlightPosition = 0;\n            this._wasTap = true;\n            this._placeholderValue = this._generatePlaceholderValue();\n            this._baseId = h.generateId(this.passedElement.element, 'choices-');\n            this._direction = this.passedElement.dir;\n            if (!this._direction) {\n                const {direction: elementDirection} = window.getComputedStyle(this.passedElement.element);\n                const {direction: documentDirection} = window.getComputedStyle(document.documentElement);\n                if (elementDirection !== documentDirection) {\n                    this._direction = elementDirection;\n                }\n            }\n            this._idNames = { itemChoice: 'item-choice' };\n            this._presetGroups = this.passedElement.optionGroups;\n            this._presetOptions = this.passedElement.options;\n            this._presetChoices = this.config.choices;\n            this._presetItems = this.config.items;\n            if (this.passedElement.value) {\n                this._presetItems = this._presetItems.concat(this.passedElement.value.split(this.config.delimiter));\n            }\n            if (this.passedElement.options) {\n                this.passedElement.options.forEach(o => {\n                    this._presetChoices.push({\n                        value: o.value,\n                        label: o.innerHTML,\n                        selected: o.selected,\n                        disabled: o.disabled || o.parentNode.disabled,\n                        placeholder: o.value === '' || o.hasAttribute('placeholder'),\n                        customProperties: o.getAttribute('data-custom-properties')\n                    });\n                });\n            }\n            this._render = this._render.bind(this);\n            this._onFocus = this._onFocus.bind(this);\n            this._onBlur = this._onBlur.bind(this);\n            this._onKeyUp = this._onKeyUp.bind(this);\n            this._onKeyDown = this._onKeyDown.bind(this);\n            this._onClick = this._onClick.bind(this);\n            this._onTouchMove = this._onTouchMove.bind(this);\n            this._onTouchEnd = this._onTouchEnd.bind(this);\n            this._onMouseDown = this._onMouseDown.bind(this);\n            this._onMouseOver = this._onMouseOver.bind(this);\n            this._onFormReset = this._onFormReset.bind(this);\n            this._onAKey = this._onAKey.bind(this);\n            this._onEnterKey = this._onEnterKey.bind(this);\n            this._onEscapeKey = this._onEscapeKey.bind(this);\n            this._onDirectionKey = this._onDirectionKey.bind(this);\n            this._onDeleteKey = this._onDeleteKey.bind(this);\n            if (this.passedElement.isActive) {\n                if (!this.config.silent) {\n                    console.warn('Trying to initialise Choices on element already initialised');\n                }\n                this.initialised = true;\n                return;\n            }\n            this.init();\n        }\n        init() {\n            if (this.initialised) {\n                return;\n            }\n            this._createTemplates();\n            this._createElements();\n            this._createStructure();\n            this._initialState = h.cloneObject(this._store.state);\n            this._store.subscribe(this._render);\n            this._render();\n            this._addEventListeners();\n            const shouldDisable = !this.config.addItems || this.passedElement.element.hasAttribute('disabled');\n            if (shouldDisable) {\n                this.disable();\n            }\n            this.initialised = true;\n            const {callbackOnInit} = this.config;\n            if (callbackOnInit && typeof callbackOnInit === 'function') {\n                callbackOnInit.call(this);\n            }\n        }\n        destroy() {\n            if (!this.initialised) {\n                return;\n            }\n            this._removeEventListeners();\n            this.passedElement.reveal();\n            this.containerOuter.unwrap(this.passedElement.element);\n            this.clearStore();\n            if (this._isSelectElement) {\n                this.passedElement.options = this._presetOptions;\n            }\n            this._templates = null;\n            this.initialised = false;\n        }\n        enable() {\n            if (this.passedElement.isDisabled) {\n                this.passedElement.enable();\n            }\n            if (this.containerOuter.isDisabled) {\n                this._addEventListeners();\n                this.input.enable();\n                this.containerOuter.enable();\n            }\n            return this;\n        }\n        disable() {\n            if (!this.passedElement.isDisabled) {\n                this.passedElement.disable();\n            }\n            if (!this.containerOuter.isDisabled) {\n                this._removeEventListeners();\n                this.input.disable();\n                this.containerOuter.disable();\n            }\n            return this;\n        }\n        highlightItem(item, runEvent = true) {\n            if (!item) {\n                return this;\n            }\n            const {id, groupId = -1, value = '', label = ''} = item;\n            const group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n            this._store.dispatch(items.highlightItem(id, true));\n            if (runEvent) {\n                this.passedElement.triggerEvent(constants.EVENTS.undefined, {\n                    id,\n                    value,\n                    label,\n                    groupValue: group && group.value ? group.value : null\n                });\n            }\n            return this;\n        }\n        unhighlightItem(item) {\n            if (!item) {\n                return this;\n            }\n            const {id, groupId = -1, value = '', label = ''} = item;\n            const group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n            this._store.dispatch(items.highlightItem(id, false));\n            this.passedElement.triggerEvent(constants.EVENTS.undefined, {\n                id,\n                value,\n                label,\n                groupValue: group && group.value ? group.value : null\n            });\n            return this;\n        }\n        highlightAll() {\n            this._store.items.forEach(item => this.undefined(item));\n            return this;\n        }\n        unhighlightAll() {\n            this._store.items.forEach(item => this.unhighlightItem(item));\n            return this;\n        }\n        removeActiveItemsByValue(value) {\n            this._store.activeItems.filter(item => item.value === value).forEach(item => this._removeItem(item));\n            return this;\n        }\n        removeActiveItems(excludedId) {\n            this._store.activeItems.filter(({id}) => id !== excludedId).forEach(item => this._removeItem(item));\n            return this;\n        }\n        removeHighlightedItems(runEvent = false) {\n            this._store.highlightedActiveItems.forEach(item => {\n                this._removeItem(item);\n                if (runEvent) {\n                    this._triggerChange(item.value);\n                }\n            });\n            return this;\n        }\n        showDropdown(preventInputFocus) {\n            if (this.dropdown.isActive) {\n                return this;\n            }\n            requestAnimationFrame(() => {\n                this.dropdown.show();\n                this.containerOuter.open(this.dropdown.distanceFromTopWindow);\n                if (!preventInputFocus && this._canSearch) {\n                    this.input.focus();\n                }\n                this.passedElement.triggerEvent(constants.EVENTS.showDropdown, {});\n            });\n            return this;\n        }\n        hideDropdown(preventInputBlur) {\n            if (!this.dropdown.isActive) {\n                return this;\n            }\n            requestAnimationFrame(() => {\n                this.dropdown.hide();\n                this.containerOuter.close();\n                if (!preventInputBlur && this._canSearch) {\n                    this.input.removeActiveDescendant();\n                    this.input.blur();\n                }\n                this.passedElement.triggerEvent(constants.EVENTS.hideDropdown, {});\n            });\n            return this;\n        }\n        getValue(valueOnly = false) {\n            const values = this._store.activeItems.reduce((selectedItems, item) => {\n                const itemValue = valueOnly ? item.value : item;\n                selectedItems.push(itemValue);\n                return selectedItems;\n            }, []);\n            return this._isSelectOneElement ? values[0] : values;\n        }\n        setValue(items) {\n            if (!this.initialised) {\n                return this;\n            }\n            items.forEach(value => this._setChoiceOrItem(value));\n            return this;\n        }\n        setChoiceByValue(value) {\n            if (!this.initialised || this._isTextElement) {\n                return this;\n            }\n            const choiceValue = Array.isArray(value) ? value : [value];\n            choiceValue.forEach(val => this._findAndSelectChoiceByValue(val));\n            return this;\n        }\n        setChoices(choicesArrayOrFetcher = [], value = 'value', label = 'label', replaceChoices = false) {\n            if (!this.initialised) {\n                throw new ReferenceError(`setChoices was called on a non-initialized instance of Choices`);\n            }\n            if (!this._isSelectElement) {\n                throw new TypeError(`setChoices can't be used with INPUT based Choices`);\n            }\n            if (typeof value !== 'string' || !value) {\n                throw new TypeError(`value parameter must be a name of 'value' field in passed objects`);\n            }\n            if (replaceChoices) {\n                this.undefined();\n            }\n            if (typeof choicesArrayOrFetcher === 'function') {\n                const fetcher = choicesArrayOrFetcher(this);\n                if (typeof Promise === 'function' && fetcher instanceof Promise) {\n                    return new Promise(resolve => requestAnimationFrame(resolve)).then(() => this._handleLoadingState(true)).then(() => fetcher).then(data => this.setChoices(data, value, label, replaceChoices)).catch(err => {\n                        if (!this.config.silent) {\n                            console.error(err);\n                        }\n                    }).then(() => this._handleLoadingState(false)).then(() => this);\n                }\n                if (!Array.isArray(fetcher)) {\n                    throw new TypeError(`.setChoices first argument function must return either array of choices or Promise, got: ${ typeof fetcher }`);\n                }\n                return this.setChoices(fetcher, value, label, false);\n            }\n            if (!Array.isArray(choicesArrayOrFetcher)) {\n                throw new TypeError(`.setChoices must be called either with array of choices with a function resulting into Promise of array of choices`);\n            }\n            this.containerOuter.removeLoadingState();\n            this._startLoading();\n            choicesArrayOrFetcher.forEach(groupOrChoice => {\n                if (groupOrChoice.choices) {\n                    this._addGroup({\n                        id: parseInt(groupOrChoice.id, 10) || null,\n                        group: groupOrChoice,\n                        valueKey: value,\n                        labelKey: label\n                    });\n                } else {\n                    this._addChoice({\n                        value: groupOrChoice[value],\n                        label: groupOrChoice[label],\n                        isSelected: groupOrChoice.selected,\n                        isDisabled: groupOrChoice.disabled,\n                        customProperties: groupOrChoice.customProperties,\n                        placeholder: groupOrChoice.placeholder\n                    });\n                }\n            });\n            this._stopLoading();\n            return this;\n        }\n        clearChoices() {\n            this._store.dispatch(actionsChoices.clearChoices());\n            return this;\n        }\n        clearStore() {\n            this._store.dispatch(misc.clearAll());\n            return this;\n        }\n        clearInput() {\n            const shouldSetInputWidth = !this._isSelectOneElement;\n            this.input.clear(shouldSetInputWidth);\n            if (!this._isTextElement && this._canSearch) {\n                this._isSearching = false;\n                this._store.dispatch(d.activateChoices(true));\n            }\n            return this;\n        }\n        _render() {\n            if (this._store.isLoading()) {\n                return;\n            }\n            this._currentState = this._store.state;\n            const stateChanged = this._currentState.choices !== this._prevState.choices || this._currentState.groups !== this._prevState.groups || this._currentState.items !== this._prevState.items;\n            const shouldRenderChoices = this._isSelectElement;\n            const shouldRenderItems = this._currentState.items !== this._prevState.items;\n            if (!stateChanged) {\n                return;\n            }\n            if (shouldRenderChoices) {\n                this._renderChoices();\n            }\n            if (shouldRenderItems) {\n                this._renderItems();\n            }\n            this._prevState = this._currentState;\n        }\n        _renderChoices() {\n            const {activeGroups, activeChoices} = this._store;\n            let choiceListFragment = document.createDocumentFragment();\n            this.choiceList.clear();\n            if (this.config.resetScrollPosition) {\n                requestAnimationFrame(() => this.choiceList.scrollToTop());\n            }\n            if (activeGroups.length >= 1 && !this._isSearching) {\n                const activePlaceholders = activeChoices.filter(activeChoice => activeChoice.placeholder === true && activeChoice.groupId === -1);\n                if (activePlaceholders.length >= 1) {\n                    choiceListFragment = this._createChoicesFragment(activePlaceholders, choiceListFragment);\n                }\n                choiceListFragment = this._createGroupsFragment(activeGroups, activeChoices, choiceListFragment);\n            } else if (activeChoices.length >= 1) {\n                choiceListFragment = this._createChoicesFragment(activeChoices, choiceListFragment);\n            }\n            if (choiceListFragment.childNodes && choiceListFragment.childNodes.length > 0) {\n                const {activeItems} = this._store;\n                const canAddItem = this._canAddItem(activeItems, this.input.value);\n                if (canAddItem.response) {\n                    this.choiceList.append(choiceListFragment);\n                    this._highlightChoice();\n                } else {\n                    this.choiceList.append(this._getTemplate('notice', canAddItem.notice));\n                }\n            } else {\n                let dropdownItem;\n                let notice;\n                if (this._isSearching) {\n                    notice = typeof this.config.noResultsText === 'function' ? this.config.noResultsText() : this.config.noResultsText;\n                    dropdownItem = this._getTemplate('notice', notice, 'no-results');\n                } else {\n                    notice = typeof this.config.noChoicesText === 'function' ? this.config.noChoicesText() : this.config.noChoicesText;\n                    dropdownItem = this._getTemplate('notice', notice, 'no-choices');\n                }\n                this.choiceList.append(dropdownItem);\n            }\n        }\n        _renderItems() {\n            const activeItems = this._store.activeItems || [];\n            this.itemList.clear();\n            const itemListFragment = this._createItemsFragment(activeItems);\n            if (itemListFragment.childNodes) {\n                this.itemList.append(itemListFragment);\n            }\n        }\n        _createGroupsFragment(groups, choices, fragment = document.createDocumentFragment()) {\n            const getGroupChoices = group => choices.filter(choice => {\n                if (this._isSelectOneElement) {\n                    return choice.groupId === group.id;\n                }\n                return choice.groupId === group.id && (this.config.renderSelectedChoices === 'always' || !choice.selected);\n            });\n            if (this.config.shouldSort) {\n                groups.sort(this.config.sorter);\n            }\n            groups.forEach(group => {\n                const groupChoices = getGroupChoices(group);\n                if (groupChoices.length >= 1) {\n                    const dropdownGroup = this._getTemplate('choiceGroup', group);\n                    fragment.appendChild(dropdownGroup);\n                    this._createChoicesFragment(groupChoices, fragment, true);\n                }\n            });\n            return fragment;\n        }\n        _createChoicesFragment(choices, fragment = document.createDocumentFragment(), withinGroup = false) {\n            const {renderSelectedChoices, searchResultLimit, renderChoiceLimit} = this.config;\n            const filter = this._isSearching ? h.sortByScore : this.config.sorter;\n            const appendChoice = choice => {\n                const shouldRender = renderSelectedChoices === 'auto' ? this._isSelectOneElement || !choice.selected : true;\n                if (shouldRender) {\n                    const dropdownItem = this._getTemplate('choice', choice, this.config.itemSelectText);\n                    fragment.appendChild(dropdownItem);\n                }\n            };\n            let rendererableChoices = choices;\n            if (renderSelectedChoices === 'auto' && !this._isSelectOneElement) {\n                rendererableChoices = choices.filter(choice => !choice.selected);\n            }\n            const {placeholderChoices, normalChoices} = rendererableChoices.reduce((acc, choice) => {\n                if (choice.placeholder) {\n                    acc.placeholderChoices.push(choice);\n                } else {\n                    acc.normalChoices.push(choice);\n                }\n                return acc;\n            }, {\n                placeholderChoices: [],\n                normalChoices: []\n            });\n            if (this.config.shouldSort || this._isSearching) {\n                normalChoices.sort(filter);\n            }\n            let choiceLimit = rendererableChoices.length;\n            const sortedChoices = this._isSelectOneElement ? [\n                ...placeholderChoices,\n                ...normalChoices\n            ] : normalChoices;\n            if (this._isSearching) {\n                choiceLimit = searchResultLimit;\n            } else if (renderChoiceLimit && renderChoiceLimit > 0 && !withinGroup) {\n                choiceLimit = renderChoiceLimit;\n            }\n            for (let i = 0; i < choiceLimit; i += 1) {\n                if (sortedChoices[i]) {\n                    appendChoice(sortedChoices[i]);\n                }\n            }\n            return fragment;\n        }\n        _createItemsFragment(items, fragment = document.createDocumentFragment()) {\n            const {shouldSortItems, sorter, removeItemButton} = this.config;\n            if (shouldSortItems && !this._isSelectOneElement) {\n                items.sort(sorter);\n            }\n            if (this._isTextElement) {\n                this.passedElement.value = items;\n            } else {\n                this.passedElement.options = items;\n            }\n            const addItemToFragment = item => {\n                const listItem = this._getTemplate('item', item, removeItemButton);\n                fragment.appendChild(listItem);\n            };\n            items.forEach(addItemToFragment);\n            return fragment;\n        }\n        _triggerChange(value) {\n            if (value === undefined || value === null) {\n                return;\n            }\n            this.passedElement.triggerEvent(constants.EVENTS.change, { value });\n        }\n        _selectPlaceholderChoice() {\n            const {placeholderChoice} = this._store;\n            if (placeholderChoice) {\n                this._addItem({\n                    value: placeholderChoice.value,\n                    label: placeholderChoice.label,\n                    choiceId: placeholderChoice.id,\n                    groupId: placeholderChoice.groupId,\n                    placeholder: placeholderChoice.placeholder\n                });\n                this._triggerChange(placeholderChoice.value);\n            }\n        }\n        _handleButtonAction(activeItems, element) {\n            if (!activeItems || !element || !this.config.removeItems || !this.config.removeItemButton) {\n                return;\n            }\n            const itemId = element.parentNode.getAttribute('data-id');\n            const itemToRemove = activeItems.find(item => item.id === parseInt(itemId, 10));\n            this._removeItem(itemToRemove);\n            this._triggerChange(itemToRemove.value);\n            if (this._isSelectOneElement) {\n                this._selectPlaceholderChoice();\n            }\n        }\n        _handleItemAction(activeItems, element, hasShiftKey = false) {\n            if (!activeItems || !element || !this.config.removeItems || this._isSelectOneElement) {\n                return;\n            }\n            const passedId = element.getAttribute('data-id');\n            activeItems.forEach(item => {\n                if (item.id === parseInt(passedId, 10) && !item.highlighted) {\n                    this.undefined(item);\n                } else if (!hasShiftKey && item.highlighted) {\n                    this.unhighlightItem(item);\n                }\n            });\n            this.input.focus();\n        }\n        _handleChoiceAction(activeItems, element) {\n            if (!activeItems || !element) {\n                return;\n            }\n            const {id} = element.dataset;\n            const choice = this._store.getChoiceById(id);\n            if (!choice) {\n                return;\n            }\n            const passedKeyCode = activeItems[0] && activeItems[0].keyCode ? activeItems[0].keyCode : null;\n            const hasActiveDropdown = this.dropdown.isActive;\n            choice.keyCode = passedKeyCode;\n            this.passedElement.triggerEvent(constants.EVENTS.choice, { choice });\n            if (!choice.selected && !choice.disabled) {\n                const canAddItem = this._canAddItem(activeItems, choice.value);\n                if (canAddItem.response) {\n                    this._addItem({\n                        value: choice.value,\n                        label: choice.label,\n                        choiceId: choice.id,\n                        groupId: choice.groupId,\n                        customProperties: choice.customProperties,\n                        placeholder: choice.placeholder,\n                        keyCode: choice.keyCode\n                    });\n                    this._triggerChange(choice.value);\n                }\n            }\n            this.clearInput();\n            if (hasActiveDropdown && this._isSelectOneElement) {\n                this.hideDropdown(true);\n                this.containerOuter.focus();\n            }\n        }\n        _handleBackspace(activeItems) {\n            if (!this.config.removeItems || !activeItems) {\n                return;\n            }\n            const lastItem = activeItems[activeItems.length - 1];\n            const hasHighlightedItems = activeItems.some(item => item.highlighted);\n            if (this.config.editItems && !hasHighlightedItems && lastItem) {\n                this.input.value = lastItem.value;\n                this.input.setWidth();\n                this._removeItem(lastItem);\n                this._triggerChange(lastItem.value);\n            } else {\n                if (!hasHighlightedItems) {\n                    this.undefined(lastItem, false);\n                }\n                this.removeHighlightedItems(true);\n            }\n        }\n        _startLoading() {\n            this._store.dispatch(misc.setIsLoading(true));\n        }\n        _stopLoading() {\n            this._store.dispatch(misc.setIsLoading(false));\n        }\n        _handleLoadingState(setLoading = true) {\n            let placeholderItem = this.itemList.getChild(`.${ this.config.classNames.placeholder }`);\n            if (setLoading) {\n                this.disable();\n                this.containerOuter.addLoadingState();\n                if (this._isSelectOneElement) {\n                    if (!placeholderItem) {\n                        placeholderItem = this._getTemplate('placeholder', this.config.loadingText);\n                        this.itemList.append(placeholderItem);\n                    } else {\n                        placeholderItem.innerHTML = this.config.loadingText;\n                    }\n                } else {\n                    this.input.placeholder = this.config.loadingText;\n                }\n            } else {\n                this.enable();\n                this.containerOuter.removeLoadingState();\n                if (this._isSelectOneElement) {\n                    placeholderItem.innerHTML = this._placeholderValue || '';\n                } else {\n                    this.input.placeholder = this._placeholderValue || '';\n                }\n            }\n        }\n        _handleSearch(value) {\n            if (!value || !this.input.isFocussed) {\n                return;\n            }\n            const {choices} = this._store;\n            const {searchFloor, searchChoices} = this.config;\n            const hasUnactiveChoices = choices.some(option => !option.active);\n            if (value && value.length >= searchFloor) {\n                const resultCount = searchChoices ? this._searchChoices(value) : 0;\n                this.passedElement.triggerEvent(constants.EVENTS.search, {\n                    value,\n                    resultCount\n                });\n            } else if (hasUnactiveChoices) {\n                this._isSearching = false;\n                this._store.dispatch(d.activateChoices(true));\n            }\n        }\n        _canAddItem(activeItems, value) {\n            let canAddItem = true;\n            let notice = typeof this.config.addItemText === 'function' ? this.config.addItemText(value) : this.config.addItemText;\n            if (!this._isSelectOneElement) {\n                const isDuplicateValue = h.existsInArray(activeItems, value);\n                if (this.config.maxItemCount > 0 && this.config.maxItemCount <= activeItems.length) {\n                    canAddItem = false;\n                    notice = typeof this.config.maxItemText === 'function' ? this.config.maxItemText(this.config.maxItemCount) : this.config.maxItemText;\n                }\n                if (!this.config.duplicateItemsAllowed && isDuplicateValue && canAddItem) {\n                    canAddItem = false;\n                    notice = typeof this.config.uniqueItemText === 'function' ? this.config.uniqueItemText(value) : this.config.uniqueItemText;\n                }\n                if (this._isTextElement && this.config.addItems && canAddItem && typeof this.config.addItemFilter === 'function' && !this.config.addItemFilter(value)) {\n                    canAddItem = false;\n                    notice = typeof this.config.customAddItemText === 'function' ? this.config.customAddItemText(value) : this.config.customAddItemText;\n                }\n            }\n            return {\n                response: canAddItem,\n                notice\n            };\n        }\n        _searchChoices(value) {\n            const newValue = typeof value === 'string' ? value.trim() : value;\n            const currentValue = typeof this._currentValue === 'string' ? this._currentValue.trim() : this._currentValue;\n            if (newValue.length < 1 && newValue === `${ currentValue } `) {\n                return 0;\n            }\n            const haystack = this._store.searchableChoices;\n            const needle = newValue;\n            const keys = [...this.config.searchFields];\n            const options = Object.assign(this.config.fuseOptions, { keys });\n            const fuse = new Fuse(haystack, options);\n            const results = fuse.search(needle);\n            this._currentValue = newValue;\n            this._highlightPosition = 0;\n            this._isSearching = true;\n            this._store.dispatch(d.filterChoices(results));\n            return results.length;\n        }\n        _addEventListeners() {\n            const {documentElement} = document;\n            documentElement.addEventListener('touchend', this._onTouchEnd, true);\n            this.containerOuter.element.addEventListener('keydown', this._onKeyDown, true);\n            this.containerOuter.element.addEventListener('mousedown', this._onMouseDown, true);\n            documentElement.addEventListener('click', this._onClick, { passive: true });\n            documentElement.addEventListener('touchmove', this._onTouchMove, { passive: true });\n            this.dropdown.element.addEventListener('mouseover', this._onMouseOver, { passive: true });\n            if (this._isSelectOneElement) {\n                this.containerOuter.element.addEventListener('focus', this._onFocus, { passive: true });\n                this.containerOuter.element.addEventListener('blur', this._onBlur, { passive: true });\n            }\n            this.input.element.addEventListener('keyup', this._onKeyUp, { passive: true });\n            this.input.element.addEventListener('focus', this._onFocus, { passive: true });\n            this.input.element.addEventListener('blur', this._onBlur, { passive: true });\n            if (this.input.element.form) {\n                this.input.element.form.addEventListener('reset', this._onFormReset, { passive: true });\n            }\n            this.input.addEventListeners();\n        }\n        _removeEventListeners() {\n            const {documentElement} = document;\n            documentElement.removeEventListener('touchend', this._onTouchEnd, true);\n            this.containerOuter.element.removeEventListener('keydown', this._onKeyDown, true);\n            this.containerOuter.element.removeEventListener('mousedown', this._onMouseDown, true);\n            documentElement.removeEventListener('click', this._onClick);\n            documentElement.removeEventListener('touchmove', this._onTouchMove);\n            this.dropdown.element.removeEventListener('mouseover', this._onMouseOver);\n            if (this._isSelectOneElement) {\n                this.containerOuter.element.removeEventListener('focus', this._onFocus);\n                this.containerOuter.element.removeEventListener('blur', this._onBlur);\n            }\n            this.input.element.removeEventListener('keyup', this._onKeyUp);\n            this.input.element.removeEventListener('focus', this._onFocus);\n            this.input.element.removeEventListener('blur', this._onBlur);\n            if (this.input.element.form) {\n                this.input.element.form.removeEventListener('reset', this._onFormReset);\n            }\n            this.input.removeEventListeners();\n        }\n        _onKeyDown(event) {\n            const {target, keyCode, ctrlKey, metaKey} = event;\n            const {activeItems} = this._store;\n            const hasFocusedInput = this.input.isFocussed;\n            const hasActiveDropdown = this.dropdown.isActive;\n            const hasItems = this.itemList.hasChildren();\n            const keyString = String.fromCharCode(keyCode);\n            const {BACK_KEY, DELETE_KEY, ENTER_KEY, A_KEY, ESC_KEY, UP_KEY, DOWN_KEY, PAGE_UP_KEY, PAGE_DOWN_KEY} = constants.KEY_CODES;\n            const hasCtrlDownKeyPressed = ctrlKey || metaKey;\n            if (!this._isTextElement && /[a-zA-Z0-9-_ ]/.test(keyString)) {\n                this.showDropdown();\n            }\n            const keyDownActions = {\n                [A_KEY]: this._onAKey,\n                [ENTER_KEY]: this._onEnterKey,\n                [ESC_KEY]: this._onEscapeKey,\n                [UP_KEY]: this._onDirectionKey,\n                [PAGE_UP_KEY]: this._onDirectionKey,\n                [DOWN_KEY]: this._onDirectionKey,\n                [PAGE_DOWN_KEY]: this._onDirectionKey,\n                [DELETE_KEY]: this._onDeleteKey,\n                [BACK_KEY]: this._onDeleteKey\n            };\n            if (keyDownActions[keyCode]) {\n                keyDownActions[keyCode]({\n                    event,\n                    target,\n                    keyCode,\n                    metaKey,\n                    activeItems,\n                    hasFocusedInput,\n                    hasActiveDropdown,\n                    hasItems,\n                    hasCtrlDownKeyPressed\n                });\n            }\n        }\n        _onKeyUp({target, keyCode}) {\n            const {value} = this.input;\n            const {activeItems} = this._store;\n            const canAddItem = this._canAddItem(activeItems, value);\n            const {\n                BACK_KEY: backKey,\n                DELETE_KEY: deleteKey\n            } = constants.KEY_CODES;\n            if (this._isTextElement) {\n                const canShowDropdownNotice = canAddItem.notice && value;\n                if (canShowDropdownNotice) {\n                    const dropdownItem = this._getTemplate('notice', canAddItem.notice);\n                    this.dropdown.element.innerHTML = dropdownItem.outerHTML;\n                    this.showDropdown(true);\n                } else {\n                    this.hideDropdown(true);\n                }\n            } else {\n                const userHasRemovedValue = (keyCode === backKey || keyCode === deleteKey) && !target.value;\n                const canReactivateChoices = !this._isTextElement && this._isSearching;\n                const canSearch = this._canSearch && canAddItem.response;\n                if (userHasRemovedValue && canReactivateChoices) {\n                    this._isSearching = false;\n                    this._store.dispatch(d.activateChoices(true));\n                } else if (canSearch) {\n                    this._handleSearch(this.input.value);\n                }\n            }\n            this._canSearch = this.config.searchEnabled;\n        }\n        _onAKey({hasItems, hasCtrlDownKeyPressed}) {\n            if (hasCtrlDownKeyPressed && hasItems) {\n                this._canSearch = false;\n                const shouldHightlightAll = this.config.removeItems && !this.input.value && this.input.element === document.activeElement;\n                if (shouldHightlightAll) {\n                    this.highlightAll();\n                }\n            }\n        }\n        _onEnterKey({event, target, activeItems, hasActiveDropdown}) {\n            const {ENTER_KEY: enterKey} = constants.KEY_CODES;\n            const targetWasButton = target.hasAttribute('data-button');\n            if (this._isTextElement && target.value) {\n                const {value} = this.input;\n                const canAddItem = this._canAddItem(activeItems, value);\n                if (canAddItem.response) {\n                    this.hideDropdown(true);\n                    this._addItem({ value });\n                    this._triggerChange(value);\n                    this.clearInput();\n                }\n            }\n            if (targetWasButton) {\n                this._handleButtonAction(activeItems, target);\n                event.preventDefault();\n            }\n            if (hasActiveDropdown) {\n                const highlightedChoice = this.dropdown.getChild(`.${ this.config.classNames.highlightedState }`);\n                if (highlightedChoice) {\n                    if (activeItems[0]) {\n                        activeItems[0].keyCode = enterKey;\n                    }\n                    this._handleChoiceAction(activeItems, highlightedChoice);\n                }\n                event.preventDefault();\n            } else if (this._isSelectOneElement) {\n                this.showDropdown();\n                event.preventDefault();\n            }\n        }\n        _onEscapeKey({hasActiveDropdown}) {\n            if (hasActiveDropdown) {\n                this.hideDropdown(true);\n                this.containerOuter.focus();\n            }\n        }\n        _onDirectionKey({event, hasActiveDropdown, keyCode, metaKey}) {\n            const {\n                DOWN_KEY: downKey,\n                PAGE_UP_KEY: pageUpKey,\n                PAGE_DOWN_KEY: pageDownKey\n            } = constants.KEY_CODES;\n            if (hasActiveDropdown || this._isSelectOneElement) {\n                this.showDropdown();\n                this._canSearch = false;\n                const directionInt = keyCode === downKey || keyCode === pageDownKey ? 1 : -1;\n                const skipKey = metaKey || keyCode === pageDownKey || keyCode === pageUpKey;\n                const selectableChoiceIdentifier = '[data-choice-selectable]';\n                let nextEl;\n                if (skipKey) {\n                    if (directionInt > 0) {\n                        nextEl = this.dropdown.element.querySelector(`${ selectableChoiceIdentifier }:last-of-type`);\n                    } else {\n                        nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);\n                    }\n                } else {\n                    const currentEl = this.dropdown.element.querySelector(`.${ this.config.classNames.highlightedState }`);\n                    if (currentEl) {\n                        nextEl = h.getAdjacentEl(currentEl, selectableChoiceIdentifier, directionInt);\n                    } else {\n                        nextEl = this.dropdown.element.querySelector(selectableChoiceIdentifier);\n                    }\n                }\n                if (nextEl) {\n                    if (!h.isScrolledIntoView(nextEl, this.choiceList.element, directionInt)) {\n                        this.choiceList.scrollToChildElement(nextEl, directionInt);\n                    }\n                    this._highlightChoice(nextEl);\n                }\n                event.preventDefault();\n            }\n        }\n        _onDeleteKey({event, target, hasFocusedInput, activeItems}) {\n            if (hasFocusedInput && !target.value && !this._isSelectOneElement) {\n                this._handleBackspace(activeItems);\n                event.preventDefault();\n            }\n        }\n        _onTouchMove() {\n            if (this._wasTap) {\n                this._wasTap = false;\n            }\n        }\n        _onTouchEnd(event) {\n            const {target} = event || event.touches[0];\n            const touchWasWithinContainer = this._wasTap && this.containerOuter.element.contains(target);\n            if (touchWasWithinContainer) {\n                const containerWasExactTarget = target === this.containerOuter.element || target === this.containerInner.element;\n                if (containerWasExactTarget) {\n                    if (this._isTextElement) {\n                        this.input.focus();\n                    } else if (this._isSelectMultipleElement) {\n                        this.showDropdown();\n                    }\n                }\n                event.stopPropagation();\n            }\n            this._wasTap = true;\n        }\n        _onMouseDown(event) {\n            const {target} = event;\n            if (!(target instanceof HTMLElement)) {\n                return;\n            }\n            if (IS_IE11 && this.choiceList.element.contains(target)) {\n                const firstChoice = this.choiceList.element.firstElementChild;\n                const isOnScrollbar = this._direction === 'ltr' ? event.offsetX >= firstChoice.offsetWidth : event.offsetX < firstChoice.offsetLeft;\n                this._isScrollingOnIe = isOnScrollbar;\n            }\n            if (target === this.input.element) {\n                return;\n            }\n            const item = target.closest('[data-button],[data-item],[data-choice]');\n            if (item instanceof HTMLElement) {\n                const hasShiftKey = event.shiftKey;\n                const {activeItems} = this._store;\n                const {dataset} = item;\n                if ('button' in dataset) {\n                    this._handleButtonAction(activeItems, item);\n                } else if ('item' in dataset) {\n                    this._handleItemAction(activeItems, item, hasShiftKey);\n                } else if ('choice' in dataset) {\n                    this._handleChoiceAction(activeItems, item);\n                }\n            }\n            event.preventDefault();\n        }\n        _onMouseOver({target}) {\n            if (target instanceof HTMLElement && 'choice' in target.dataset) {\n                this._highlightChoice(target);\n            }\n        }\n        _onClick({target}) {\n            const clickWasWithinContainer = this.containerOuter.element.contains(target);\n            if (clickWasWithinContainer) {\n                if (!this.dropdown.isActive && !this.containerOuter.isDisabled) {\n                    if (this._isTextElement) {\n                        if (document.activeElement !== this.input.element) {\n                            this.input.focus();\n                        }\n                    } else {\n                        this.showDropdown();\n                        this.containerOuter.focus();\n                    }\n                } else if (this._isSelectOneElement && target !== this.input.element && !this.dropdown.element.contains(target)) {\n                    this.hideDropdown();\n                }\n            } else {\n                const hasHighlightedItems = this._store.highlightedActiveItems.length > 0;\n                if (hasHighlightedItems) {\n                    this.unhighlightAll();\n                }\n                this.containerOuter.removeFocusState();\n                this.hideDropdown(true);\n            }\n        }\n        _onFocus({target}) {\n            const focusWasWithinContainer = this.containerOuter.element.contains(target);\n            if (!focusWasWithinContainer) {\n                return;\n            }\n            const focusActions = {\n                [constants.TEXT_TYPE]: () => {\n                    if (target === this.input.element) {\n                        this.containerOuter.addFocusState();\n                    }\n                },\n                [constants.SELECT_ONE_TYPE]: () => {\n                    this.containerOuter.addFocusState();\n                    if (target === this.input.element) {\n                        this.showDropdown(true);\n                    }\n                },\n                [constants.SELECT_MULTIPLE_TYPE]: () => {\n                    if (target === this.input.element) {\n                        this.showDropdown(true);\n                        this.containerOuter.addFocusState();\n                    }\n                }\n            };\n            focusActions[this.passedElement.element.type]();\n        }\n        _onBlur({target}) {\n            const blurWasWithinContainer = this.containerOuter.element.contains(target);\n            if (blurWasWithinContainer && !this._isScrollingOnIe) {\n                const {activeItems} = this._store;\n                const hasHighlightedItems = activeItems.some(item => item.highlighted);\n                const blurActions = {\n                    [constants.TEXT_TYPE]: () => {\n                        if (target === this.input.element) {\n                            this.containerOuter.removeFocusState();\n                            if (hasHighlightedItems) {\n                                this.unhighlightAll();\n                            }\n                            this.hideDropdown(true);\n                        }\n                    },\n                    [constants.SELECT_ONE_TYPE]: () => {\n                        this.containerOuter.removeFocusState();\n                        if (target === this.input.element || target === this.containerOuter.element && !this._canSearch) {\n                            this.hideDropdown(true);\n                        }\n                    },\n                    [constants.SELECT_MULTIPLE_TYPE]: () => {\n                        if (target === this.input.element) {\n                            this.containerOuter.removeFocusState();\n                            this.hideDropdown(true);\n                            if (hasHighlightedItems) {\n                                this.unhighlightAll();\n                            }\n                        }\n                    }\n                };\n                blurActions[this.passedElement.element.type]();\n            } else {\n                this._isScrollingOnIe = false;\n                this.input.element.focus();\n            }\n        }\n        _onFormReset() {\n            this._store.dispatch(misc.resetTo(this._initialState));\n        }\n        _highlightChoice(el = null) {\n            const choices = Array.from(this.dropdown.element.querySelectorAll('[data-choice-selectable]'));\n            if (!choices.length) {\n                return;\n            }\n            let passedEl = el;\n            const highlightedChoices = Array.from(this.dropdown.element.querySelectorAll(`.${ this.config.classNames.highlightedState }`));\n            highlightedChoices.forEach(choice => {\n                choice.classList.remove(this.config.classNames.highlightedState);\n                choice.setAttribute('aria-selected', 'false');\n            });\n            if (passedEl) {\n                this._highlightPosition = choices.indexOf(passedEl);\n            } else {\n                if (choices.length > this._highlightPosition) {\n                    passedEl = choices[this._highlightPosition];\n                } else {\n                    passedEl = choices[choices.length - 1];\n                }\n                if (!passedEl) {\n                    passedEl = choices[0];\n                }\n            }\n            passedEl.classList.add(this.config.classNames.highlightedState);\n            passedEl.setAttribute('aria-selected', 'true');\n            this.passedElement.triggerEvent(constants.EVENTS.highlightChoice, { el: passedEl });\n            if (this.dropdown.isActive) {\n                this.input.setActiveDescendant(passedEl.id);\n                this.containerOuter.setActiveDescendant(passedEl.id);\n            }\n        }\n        _addItem({value, label = null, choiceId = -1, groupId = -1, customProperties = null, placeholder = false, keyCode = null}) {\n            let passedValue = typeof value === 'string' ? value.trim() : value;\n            const passedKeyCode = keyCode;\n            const passedCustomProperties = customProperties;\n            const {items} = this._store;\n            const passedLabel = label || passedValue;\n            const passedOptionId = choiceId || -1;\n            const group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n            const id = items ? items.length + 1 : 1;\n            if (this.config.prependValue) {\n                passedValue = this.config.prependValue + passedValue.toString();\n            }\n            if (this.config.appendValue) {\n                passedValue += this.config.appendValue.toString();\n            }\n            this._store.dispatch(items.addItem({\n                value: passedValue,\n                label: passedLabel,\n                id,\n                choiceId: passedOptionId,\n                groupId,\n                customProperties,\n                placeholder,\n                keyCode: passedKeyCode\n            }));\n            if (this._isSelectOneElement) {\n                this.removeActiveItems(id);\n            }\n            this.passedElement.triggerEvent(constants.EVENTS.undefined, {\n                id,\n                value: passedValue,\n                label: passedLabel,\n                customProperties: passedCustomProperties,\n                groupValue: group && group.value ? group.value : undefined,\n                keyCode: passedKeyCode\n            });\n            return this;\n        }\n        _removeItem(item) {\n            if (!item || !h.isType('Object', item)) {\n                return this;\n            }\n            const {id, value, label, choiceId, groupId} = item;\n            const group = groupId >= 0 ? this._store.getGroupById(groupId) : null;\n            this._store.dispatch(items.removeItem(id, choiceId));\n            if (group && group.value) {\n                this.passedElement.triggerEvent(constants.EVENTS.undefined, {\n                    id,\n                    value,\n                    label,\n                    groupValue: group.value\n                });\n            } else {\n                this.passedElement.triggerEvent(constants.EVENTS.undefined, {\n                    id,\n                    value,\n                    label\n                });\n            }\n            return this;\n        }\n        _addChoice({value, label = null, isSelected = false, isDisabled = false, groupId = -1, customProperties = null, placeholder = false, keyCode = null}) {\n            if (typeof value === 'undefined' || value === null) {\n                return;\n            }\n            const {choices} = this._store;\n            const choiceLabel = label || value;\n            const choiceId = choices ? choices.length + 1 : 1;\n            const choiceElementId = `${ this._baseId }-${ this._idNames.itemChoice }-${ choiceId }`;\n            this._store.dispatch(d.addChoice({\n                id: choiceId,\n                groupId,\n                elementId: choiceElementId,\n                value,\n                label: choiceLabel,\n                disabled: isDisabled,\n                customProperties,\n                placeholder,\n                keyCode\n            }));\n            if (isSelected) {\n                this._addItem({\n                    value,\n                    label: choiceLabel,\n                    choiceId,\n                    customProperties,\n                    placeholder,\n                    keyCode\n                });\n            }\n        }\n        _addGroup({group, id, valueKey = 'value', labelKey = 'label'}) {\n            const groupChoices = h.isType('Object', group) ? group.choices : Array.from(group.getElementsByTagName('OPTION'));\n            const groupId = id || Math.floor(new Date().valueOf() * Math.random());\n            const isDisabled = group.disabled ? group.disabled : false;\n            if (groupChoices) {\n                this._store.dispatch(groups.addGroup({\n                    value: group.label,\n                    id: groupId,\n                    active: true,\n                    disabled: isDisabled\n                }));\n                const addGroupChoices = choice => {\n                    const isOptDisabled = choice.disabled || choice.parentNode && choice.parentNode.disabled;\n                    this._addChoice({\n                        value: choice[valueKey],\n                        label: h.isType('Object', choice) ? choice[labelKey] : choice.innerHTML,\n                        isSelected: choice.selected,\n                        isDisabled: isOptDisabled,\n                        groupId,\n                        customProperties: choice.customProperties,\n                        placeholder: choice.placeholder\n                    });\n                };\n                groupChoices.forEach(addGroupChoices);\n            } else {\n                this._store.dispatch(groups.addGroup({\n                    value: group.label,\n                    id: group.id,\n                    active: false,\n                    disabled: group.disabled\n                }));\n            }\n        }\n        _getTemplate(template, ...args) {\n            if (!template) {\n                return null;\n            }\n            const {classNames} = this.config;\n            return this._templates[template].call(this, classNames, ...args);\n        }\n        _createTemplates() {\n            const {callbackOnCreateTemplates} = this.config;\n            let userTemplates = {};\n            if (callbackOnCreateTemplates && typeof callbackOnCreateTemplates === 'function') {\n                userTemplates = callbackOnCreateTemplates.call(this, h.strToEl);\n            }\n            this._templates = merge(TEMPLATES, userTemplates);\n        }\n        _createElements() {\n            this.containerOuter = new components.Container({\n                element: this._getTemplate('containerOuter', this._direction, this._isSelectElement, this._isSelectOneElement, this.config.searchEnabled, this.passedElement.element.type),\n                classNames: this.config.classNames,\n                type: this.passedElement.element.type,\n                position: this.config.position\n            });\n            this.containerInner = new components.Container({\n                element: this._getTemplate('containerInner'),\n                classNames: this.config.classNames,\n                type: this.passedElement.element.type,\n                position: this.config.position\n            });\n            this.input = new components.Input({\n                element: this._getTemplate('input', this._placeholderValue),\n                classNames: this.config.classNames,\n                type: this.passedElement.element.type,\n                preventPaste: !this.config.paste\n            });\n            this.choiceList = new components.List({ element: this._getTemplate('choiceList', this._isSelectOneElement) });\n            this.itemList = new components.List({ element: this._getTemplate('itemList', this._isSelectOneElement) });\n            this.dropdown = new components.Dropdown({\n                element: this._getTemplate('dropdown'),\n                classNames: this.config.classNames,\n                type: this.passedElement.element.type\n            });\n        }\n        _createStructure() {\n            this.passedElement.conceal();\n            this.containerInner.wrap(this.passedElement.element);\n            this.containerOuter.wrap(this.containerInner.element);\n            if (this._isSelectOneElement) {\n                this.input.placeholder = this.config.searchPlaceholderValue || '';\n            } else if (this._placeholderValue) {\n                this.input.placeholder = this._placeholderValue;\n                this.input.setWidth();\n            }\n            this.containerOuter.element.appendChild(this.containerInner.element);\n            this.containerOuter.element.appendChild(this.dropdown.element);\n            this.containerInner.element.appendChild(this.itemList.element);\n            if (!this._isTextElement) {\n                this.dropdown.element.appendChild(this.choiceList.element);\n            }\n            if (!this._isSelectOneElement) {\n                this.containerInner.element.appendChild(this.input.element);\n            } else if (this.config.searchEnabled) {\n                this.dropdown.element.insertBefore(this.input.element, this.dropdown.element.firstChild);\n            }\n            if (this._isSelectElement) {\n                this._highlightPosition = 0;\n                this._isSearching = false;\n                this._startLoading();\n                if (this._presetGroups.length) {\n                    this._addPredefinedGroups(this._presetGroups);\n                } else {\n                    this._addPredefinedChoices(this._presetChoices);\n                }\n                this._stopLoading();\n            }\n            if (this._isTextElement) {\n                this._addPredefinedItems(this._presetItems);\n            }\n        }\n        _addPredefinedGroups(groups) {\n            const placeholderChoice = this.passedElement.placeholderOption;\n            if (placeholderChoice && placeholderChoice.parentNode.tagName === 'SELECT') {\n                this._addChoice({\n                    value: placeholderChoice.value,\n                    label: placeholderChoice.innerHTML,\n                    isSelected: placeholderChoice.selected,\n                    isDisabled: placeholderChoice.disabled,\n                    placeholder: true\n                });\n            }\n            groups.forEach(group => this._addGroup({\n                group,\n                id: group.id || null\n            }));\n        }\n        _addPredefinedChoices(choices) {\n            if (this.config.shouldSort) {\n                choices.sort(this.config.sorter);\n            }\n            const hasSelectedChoice = choices.some(choice => choice.selected);\n            const firstEnabledChoiceIndex = choices.findIndex(choice => choice.disabled === undefined || !choice.disabled);\n            choices.forEach((choice, index) => {\n                const {value, label, customProperties, placeholder} = choice;\n                if (this._isSelectElement) {\n                    if (choice.choices) {\n                        this._addGroup({\n                            group: choice,\n                            id: choice.id || null\n                        });\n                    } else {\n                        const shouldPreselect = this._isSelectOneElement && !hasSelectedChoice && index === firstEnabledChoiceIndex;\n                        const isSelected = shouldPreselect ? true : choice.selected;\n                        const isDisabled = choice.disabled;\n                        this._addChoice({\n                            value,\n                            label,\n                            isSelected,\n                            isDisabled,\n                            customProperties,\n                            placeholder\n                        });\n                    }\n                } else {\n                    this._addChoice({\n                        value,\n                        label,\n                        isSelected: choice.selected,\n                        isDisabled: choice.disabled,\n                        customProperties,\n                        placeholder\n                    });\n                }\n            });\n        }\n        _addPredefinedItems(items) {\n            items.forEach(item => {\n                if (typeof item === 'object' && item.value) {\n                    this._addItem({\n                        value: item.value,\n                        label: item.label,\n                        choiceId: item.id,\n                        customProperties: item.customProperties,\n                        placeholder: item.placeholder\n                    });\n                }\n                if (typeof item === 'string') {\n                    this._addItem({ value: item });\n                }\n            });\n        }\n        _setChoiceOrItem(item) {\n            const itemType = h.getType(item).toLowerCase();\n            const handleType = {\n                object: () => {\n                    if (!item.value) {\n                        return;\n                    }\n                    if (!this._isTextElement) {\n                        this._addChoice({\n                            value: item.value,\n                            label: item.label,\n                            isSelected: true,\n                            isDisabled: false,\n                            customProperties: item.customProperties,\n                            placeholder: item.placeholder\n                        });\n                    } else {\n                        this._addItem({\n                            value: item.value,\n                            label: item.label,\n                            choiceId: item.id,\n                            customProperties: item.customProperties,\n                            placeholder: item.placeholder\n                        });\n                    }\n                },\n                string: () => {\n                    if (!this._isTextElement) {\n                        this._addChoice({\n                            value: item,\n                            label: item,\n                            isSelected: true,\n                            isDisabled: false\n                        });\n                    } else {\n                        this._addItem({ value: item });\n                    }\n                }\n            };\n            handleType[itemType]();\n        }\n        _findAndSelectChoiceByValue(val) {\n            const {choices} = this._store;\n            const foundChoice = choices.find(choice => this.config.valueComparer(choice.value, val));\n            if (foundChoice && !foundChoice.selected) {\n                this._addItem({\n                    value: foundChoice.value,\n                    label: foundChoice.label,\n                    choiceId: foundChoice.id,\n                    groupId: foundChoice.groupId,\n                    customProperties: foundChoice.customProperties,\n                    placeholder: foundChoice.placeholder,\n                    keyCode: foundChoice.keyCode\n                });\n            }\n        }\n        _generatePlaceholderValue() {\n            if (this._isSelectElement) {\n                const {placeholderOption} = this.passedElement;\n                return placeholderOption ? placeholderOption.text : false;\n            }\n            const {placeholder, placeholderValue} = this.config;\n            const {\n                element: {dataset}\n            } = this.passedElement;\n            if (placeholder) {\n                if (placeholderValue) {\n                    return placeholderValue;\n                }\n                if (dataset.placeholder) {\n                    return dataset.placeholder;\n                }\n            }\n            return false;\n        }\n    }\n    return Choices;\n});"]}